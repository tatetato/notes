<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta http-equiv="X-UA-Compatible" content="ie=edge" />
    <title>Curriculum</title>
    <style>
      html {
        width: 100vw;
        overflow-x: hidden;
      }

      .table {
        min-width: 800px;
      }

      .table-row {
        display: grid;
        grid-template-columns: 6rem 3rem repeat(5, 1fr);
      }

      .period-box {
        display: grid;
        grid-template-rows: repeat(auto-fill, 1fr);
      }

      .period-header {
        background-color: #d3d3d3;
        font-size: 22px;
        text-align: center;
      }

      .table-cell {
        border: 1px solid gray;
      }

      .period-cell {
        border: 1px solid gray;
        min-height: 6rem;
      }

      .time-box {
        display: grid;
        grid-template-rows: repeat(auto-fill, 1fr);
        text-align: center;
      }

      .time-cell {
        min-height: 2rem;
      }

      .floor-number {
        text-align: center;
        font-size: 3rem;
        color: rgb(53, 15, 124);
        font-family: Impact, Haettenschweiler, "Arial Narrow Bold", sans-serif;
      }

      .highlight {
        background-color: rgb(255, 241, 116);
      }

      .indicator {
        height: 6px;
        background-color: rgba(255, 0, 0, 0.526);
        position: absolute;
        width: 100vw;
        top: 0;
        transition: all ease 0.3s;
      }

      .indicator::after {
        content: "‰ªä„Åì„Åì";
        font-size: 14px;
        color: rgb(15, 90, 252);
        transform: translateY(-50%);
        position: absolute;
      }

      .text-center {
        text-align: center;
      }

      .relative {
        position: relative;
      }

      .py-1 {
        padding-top: 1rem;
        padding-bottom: 1rem;
      }

      .py-2 {
        padding-top: 2rem;
        padding-bottom: 2rem;
      }
    </style>
  </head>

  <body>
    <div class="table">
      <div class="table-header">
        <div class="table-row">
          <div class="table-cell"></div>
          <div class="table-cell"></div>
          <div id="weekdayContainer"></div>
        </div>
      </div>
      <div class="table-body">
        <div class="table-row">
          <div class="table-cell" id="time-box-1"></div>
          <div class="table-cell period-header"></div>
          <div class="table-cell">
            <div class="period-box">
              <div class="period-cell">
                Web „Éá„Ç∂„Ç§„É≥ I
              </div>
              <div class="period-cell">
                Â≤©Êú¨
              </div>
              <div class="period-cell floor-number">
                43
              </div>
            </div>
          </div>
          <div class="table-cell">
            <div class="period-box">
              <div class="period-cell">
                Ëã±Ë™û I
              </div>
              <div class="period-cell">
                „Éà„Éô„ÄÄ„Çµ„É©„Éü
              </div>
              <div class="period-cell floor-number">
                21
              </div>
            </div>
          </div>
          <div class="table-cell">
            <div class="period-box">
              <div class="period-cell">
                „Éç„ÉÉ„Éà„ÉØ„Éº„ÇØ I
              </div>
              <div class="period-cell">
                Ê∑±Áî∞
              </div>
              <div class="period-cell floor-number">
                24
              </div>
              <!-- classroom „ÅßÂá∫Â∏≠Á¢∫Ë™çÂøÖË¶Å
            ÊïôÁßëÊõ∏„ÅÆ point „ÅØË©¶È®ì„ÅÆÊôÇÂá∫„Çã„Åã„ÇÇ„Åó„Çå„Åæ„Åõ„Çì -->
            </div>
          </div>
          <div class="table-cell">
            <div class="period-box">
              <div class="period-cell">
                „Éì„Ç∏„Éç„ÇπÊó•Êú¨Ë™ûÁ∑¥Áøí I
              </div>
              <div class="period-cell">
                ÂêâÁî∞
              </div>
              <div class="period-cell floor-number">
                21
              </div>
            </div>
          </div>
          <div class="table-cell">
            <div class="period-box">
              <div class="period-cell">
                „Éó„É≠„Ç∞„É©„Éü„É≥„Ç∞ I
              </div>
              <div class="period-cell">
                Ê†πÂ≤∏
              </div>
              <div class="period-cell floor-number">
                61
              </div>
            </div>
          </div>
        </div>
        <div class="table-row">
          <div class="table-cell" id="time-box-2"></div>
          <div class="table-cell period-header"></div>
          <div class="table-cell">
            <div class="period-box">
              <div class="period-cell">
                Web „Éá„Ç∂„Ç§„É≥ I
              </div>
              <div class="period-cell">
                Â≤©Êú¨
              </div>
              <div class="period-cell floor-number">
                43
              </div>
            </div>
          </div>
          <div class="table-cell">
            <div class="period-box">
              <div class="period-cell">
                „Éì„Ç∏„Éç„Çπ„ÇΩ„Éï„Éà I A (Excel)
              </div>
              <div class="period-cell">
                Ê£ÆÔºàÁÉàÔºâ
              </div>
              <div class="period-cell floor-number">
                61
              </div>
            </div>
          </div>
          <div class="table-cell">
            <div class="period-box">
              <div class="period-cell">
                „Éì„Ç∏„Éç„Çπ„ÇΩ„Éï„Éà I B (Word)
              </div>
              <div class="period-cell">
                ‰ºäËó§
              </div>
              <div class="period-cell floor-number">
                24
              </div>
            </div>
          </div>
          <div class="table-cell">
            <div class="period-box">
              <div class="period-cell">
                „Ç≥„É≥„Éî„É•„Éº„Çø„Éº„Ç∑„Çπ„ÉÜ„É† I
              </div>
              <div class="period-cell">
                Â±±Â¥é
              </div>
              <div class="period-cell floor-number">
                31
              </div>
            </div>
          </div>
          <div class="table-cell">
            <div class="period-box">
              <div class="period-cell">
                „Éó„É≠„Ç∞„É©„Éü„É≥„Ç∞ I
              </div>
              <div class="period-cell">
                Ê†πÂ≤∏
              </div>
              <div class="period-cell floor-number">
                61
              </div>
            </div>
          </div>
        </div>
        <div class="table-row">
          <div class="table-cell" id="time-box-3"></div>
          <div class="table-cell period-header"></div>
          <div class="table-cell">
            <div class="period-box">
              <div class="period-cell">
                „Éì„Ç∏„Éç„ÇπÊó•Êú¨Ë™û I
              </div>
              <div class="period-cell">
                Êæ§Áî∞
              </div>
              <div class="period-cell floor-number">
                41
              </div>
            </div>
          </div>
          <div class="table-cell">
            <div class="period-box">
              <div class="period-cell">
                „Éì„Ç∏„Éç„ÇπÂü∫Á§é I
              </div>
              <div class="period-cell">
                Ê£ÆÔºàÂ§ßÔºâ
              </div>
              <div class="period-cell floor-number">
                21
              </div>
            </div>
          </div>
          <div class="table-cell">
            <div class="period-box">
              <div class="period-cell">
                12:35~13:00 HR
              </div>
              <div class="period-cell">
                ÊãÖ‰ªª
              </div>
              <div class="period-cell floor-number">
                24
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- https://releases.jquery.com/ -->
    <script
      src="https://code.jquery.com/jquery-3.7.1.min.js"
      integrity="sha256-/JqT3SQfawRcv/BIHPThkBvs0OEvtFFmqPF/lYI/Cxo="
      crossorigin="anonymous"
    ></script>
    <script>
      $(document).ready(function() {
        function createPeriodHeader(time) {
          let $periodHeader = $(` 
          <div class="period-box ">
            <div class="period-cell" style="">
              ÁßëÁõÆ üìö 
            </div>
            <div class="period-cell">
              ÂÖàÁîü üë©‚Äçüè´
            </div>
            <div class="period-cell">
              ÊïôÂÆ§ üè´
            </div>
          </div>
            `);

          return $periodHeader;
        }

        $.each($(".period-header"), function(index, item) {
          let $periodHeader = createPeriodHeader();
          $(item).append($periodHeader);
        });

        let weekdays = ["Êó•", "Êúà", "ÁÅ´", "Ê∞¥", "Êú®", "Èáë", "Âúü"];

        function createWeekday(weekday) {
          let $weekday = $("<div></div>")
            .text(weekday)
            .addClass(["table-cell", "text-center", "py-1"]);

          let today = new Date().getDay();

          if (weekday === weekdays[today]) {
            $weekday.addClass("highlight");
          }

          return $weekday;
        }

        $.each(weekdays.slice(1, 6), function(index, label) {
          let $weekday = createWeekday(label);
          $("#weekdayContainer").append($weekday);
        });

        setTimeout(() => {
          // wait for all the weekdays
          // how to resolve this async problem in jquery
          $("#weekdayContainer")
            .children()
            .unwrap();
        });

        let courseTimeObjects = [
          {
            index: 0,
            startTime: "9:20",
            endTime: "10:50"
          },
          {
            index: 1,
            startTime: "11:05",
            endTime: "12:35"
          },
          {
            index: 2,
            startTime: "13:25",
            endTime: "14:55"
          }
        ];

        function compareWithCurrentTime(timeObject) {
          const currentTime = new Date();
          const startTime = new Date();
          const endTime = new Date();

          const [startHours, startMinutes] = timeObject.startTime.split(":");
          startTime.setHours(startHours);
          startTime.setMinutes(startMinutes);

          const [endHours, endMinutes] = timeObject.endTime.split(":");
          endTime.setHours(endHours);
          endTime.setMinutes(endMinutes);

          let deltaStartPercent = -1;
          let result = currentTime > startTime && currentTime < endTime;

          if (result) {
            deltaStartPercent =
              ((currentTime - startTime) / (endTime - startTime)) * 100;
          }

          return { result, deltaStartPercent };
        }

        function createCourseTime(time) {
          let $courseTime = $(` 
            <div class="time-box">
            <div class="time-cell">
              ${time.index + 1}Èôê
            </div>
            <div class="time-cell">
              ${time.startTime}
            </div>
            <div class="time-cell">
              ~
            </div>
            <div class="time-cell">
                ${time.endTime}
            </div>
            </div>`);

          return $courseTime;
        }

        $.each(courseTimeObjects, function(index, time) {
          let $courseTime = createCourseTime(time);
          $(`#time-box-${time.index + 1}`).append($courseTime);
        });

        $.each(courseTimeObjects, function(index, time) {
          const compared = compareWithCurrentTime(time);

          if (compared.result) {
            let $timeBox = $(`#time-box-${time.index + 1}`);

            $timeBox.addClass("highlight").addClass("relative");

            let $indicator = $("<div class='indicator'></div>").css(
              "top",
              `${compared.deltaStartPercent}%`
            );
            $timeBox.append($indicator);
          }
        });

        $(window).on("focus", function() {
          $.each(courseTimeObjects, function(index, time) {
            let $timeBox = $(`#time-box-${time.index + 1}`);
            $timeBox.removeClass("highlight");
            $timeBox.children().remove("indicator");

            const compared = compareWithCurrentTime(time);

            if (compared.result) {
              $timeBox.addClass("highlight").addClass("relative");

              let $indicator = $("<div class='indicator'></div>").css(
                "top",
                `${compared.deltaStartPercent}%`
              );
              $timeBox.append($indicator);
            }
          });
        });
      });
    </script>
  </body>
</html>
